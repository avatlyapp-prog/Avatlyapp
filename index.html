<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Avatly</title>

  <!-- PWA -->
  <meta name="theme-color" content="#5A1F2A" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" href="icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="icon-512.png" />

  <link rel="stylesheet" href="styles.css?v=3" />
</head>
<body>
  <div class="app" id="app">
    <!-- Meteo pill -->
    <div class="weather-pill" id="weatherPill" aria-live="polite" title="Meteo">
      <span>☁️</span> <strong id="weatherTemp">22°</strong>
    </div>

    <!-- Messaggi AI -->
    <div class="toast" id="aiToast" role="status" aria-live="polite" hidden></div>

    <main id="main">
      <!-- Stage avatar -->
      <section id="avatarStage" class="avatar-stage dotted">
        <canvas id="avatarCanvas" width="320" height="320" aria-label="Avatar"></canvas>
      </section>

      <p class="hint">
        Tocca <span class="icon">⚙️</span> per personalizzare
      </p>

      <!-- Floating settings button -->
      <button class="fab" id="avatarFab" aria-label="Personalizza avatar">⚙️</button>
    </main>

    <!-- Bottom navigation -->
    <nav class="bottom-nav" aria-label="Navigazione principale">
      <button class="tab" data-tab="ai" aria-label="AI"><span>✦</span><small>AI</small></button>
      <button class="tab" data-tab="wardrobe" aria-label="Armadio"><span>🧴</span><small>Armadio</small></button>
      <button class="tab active" data-tab="home" aria-label="Home"><span>🏠</span><small>Home</small></button>
      <button class="tab" data-tab="calendar" aria-label="Calendario"><span>📅</span><small>Calendario</small></button>
      <button class="tab" data-tab="settings" aria-label="Impostazioni"><span>⚙️</span><small>Impostazioni</small></button>
    </nav>
  </div>

  <!-- Modale personalizzazione avatar -->
  <dialog id="avatarModal" class="modal">
    <form method="dialog" class="modal-content" id="avatarForm">
      <header class="modal-header">
        <span class="icon">⚙️</span>
        <h3>Personalizza avatar</h3>
        <button type="button" class="close" id="closeModal" aria-label="Chiudi">✕</button>
      </header>

      <div class="fields">
        <label>
          Altezza (cm)
          <input inputmode="numeric" pattern="[0-9]*" id="heightInput" placeholder="es. 168" />
        </label>
        <label>
          Peso (kg)
          <input inputmode="numeric" pattern="[0-9]*" id="weightInput" placeholder="es. 58" />
        </label>
        <label class="span2">
          Forma
          <select id="shapeSelect">
            <option value="">Seleziona…</option>
            <option value="dritta">Dritta</option>
            <option value="clessidra">Clessidra</option>
            <option value="pera">Pera</option>
            <option value="mela">Mela</option>
          </select>
        </label>
      </div>

      <div class="avatar-mini-wrap">
        <canvas id="miniAvatar" width="80" height="120" aria-hidden="true"></canvas>
      </div>

      <footer class="modal-actions">
        <button type="submit" class="btn-primary">Salva</button>
      </footer>
    </form>
  </dialog>

  <script src="app.js?v=3" type="module"></script>
</body>
</html>
